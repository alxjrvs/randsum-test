"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.applyReroll = void 0;
function rerollRoll(roll, _a, rollOne, index) {
    var above = _a.above, below = _a.below, on = _a.on, maxReroll = _a.maxReroll;
    if (index === void 0) { index = 0; }
    if (maxReroll === index) {
        return roll;
    }
    if (index === 99) {
        console.warn('You have rerolled 99 times, stopping reroll.');
        return roll;
    }
    switch (true) {
        case above !== undefined && roll > above:
        case below !== undefined && roll < below:
        case on !== undefined && Array.isArray(on) ? on.includes(roll) : on === roll:
            return rerollRoll(rollOne(), { above: above, below: below, on: on, maxReroll: maxReroll }, rollOne, index + 1);
        default:
            return roll;
    }
}
function applyReroll(rollTotals, reroll, rollOne) {
    var parameters = Array.isArray(reroll) ? reroll : [reroll];
    var rerollRolls = rollTotals;
    var _loop_1 = function (rerollModifier) {
        rerollRolls = rerollRolls.map(function (roll) {
            return rerollRoll(roll, rerollModifier, rollOne);
        });
    };
    for (var _i = 0, parameters_1 = parameters; _i < parameters_1.length; _i++) {
        var rerollModifier = parameters_1[_i];
        _loop_1(rerollModifier);
    }
    return rerollRolls;
}
exports.applyReroll = applyReroll;
//# sourceMappingURL=apply-reroll.js.map